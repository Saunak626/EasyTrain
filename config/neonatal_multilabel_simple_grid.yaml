# æ–°ç”Ÿå„¿å¤šæ ‡ç­¾è¡Œä¸ºè¯†åˆ«ç½‘æ ¼æœç´¢é…ç½® - ç®€åŒ–ç‰ˆ
# ä½¿ç”¨ç®€åŒ–ç‰ˆæ•°æ®é›† NeonatalMultilabelSimple

# ä»»åŠ¡é…ç½®
task:
  tag: "video_classification"
  description: "æ–°ç”Ÿå„¿å¤šæ ‡ç­¾è¡Œä¸ºè¯†åˆ«ç½‘æ ¼æœç´¢ - ç®€åŒ–ç‰ˆæ•°æ®é›†"

# è®­ç»ƒé…ç½®
training:
  exp_name: "neonatal_multilabel_simple_exp"
  save_model: true
  model_save_path: "models/neonatal_multilabel_simple_model.pth"

# SwanLabé…ç½®
swanlab:
  project_name: "EasyTrain-Neonatal-Multilabel-Simple"
  description: "æ–°ç”Ÿå„¿å¤šæ ‡ç­¾è¡Œä¸ºè¯†åˆ«ç½‘æ ¼æœç´¢å®éªŒ - ç®€åŒ–ç‰ˆæ•°æ®é›†"

# æ•°æ®é…ç½®
data:
  type: neonatal_multilabel_simple  # ä½¿ç”¨ç®€åŒ–ç‰ˆæ•°æ®é›†ç±»å‹
  root: ../Neonate-Feeding-Assessment/data/cpu_processed_627/frames_segments
  num_workers: 32  # ğŸ”§ ä¼˜åŒ–ï¼šé™ä½workeræ•°é‡ï¼Œå‡å°‘ç£ç›˜I/Oç«äº‰ï¼ˆåŸ12 -> 4ï¼‰
  params:
    clip_len: 16      # æ¯ä¸ªè§†é¢‘ç‰‡æ®µçš„å¸§æ•°
    train_ratio: 0.8  # è®­ç»ƒé›†æ¯”ä¾‹ï¼ˆç®€åŒ–ç‰ˆç‹¬æœ‰å‚æ•°ï¼‰
    # æ ‡ç­¾æ–‡ä»¶è·¯å¾„
    labels_file: ../Neonate-Feeding-Assessment/result_xlsx/shanghai/multi_hot_labels.xlsx
    
    # æ³¨æ„ï¼šç®€åŒ–ç‰ˆä¸æ”¯æŒä»¥ä¸‹å‚æ•°
    # top_n_classes: ä¸æ”¯æŒï¼ˆå›ºå®šä½¿ç”¨å…¨éƒ¨24ä¸ªç±»åˆ«ï¼‰
    # stratified_split: ä¸æ”¯æŒï¼ˆä½¿ç”¨ç®€å•åˆ’åˆ†ï¼‰
    # min_samples_per_class: ä¸æ”¯æŒ
    # use_weighted_sampling: ä¸æ”¯æŒ
    # sampling_mode: ä¸æ”¯æŒï¼ˆå›ºå®šä½¿ç”¨randomé‡‡æ ·ï¼‰
    # target_fps: ä¸æ”¯æŒ
    # original_fps: ä¸æ”¯æŒ

# è¶…å‚æ•°é…ç½®
hp:
  epochs: 10

# GPUé…ç½®
gpu:
  device_ids: "0"
  auto_select: true

# å¤šå¡è®­ç»ƒé…ç½®
multi_gpu:
  enabled: true
  strategy: "ddp"

# æ¨¡å‹é€‰æ‹©é…ç½®ï¼ˆç®€åŒ–ç‰ˆï¼šåªæµ‹è¯•è½»é‡çº§æ¨¡å‹ï¼‰
models_to_train:
  - "r3d_18"
  - "mc3_18"
  # - "r2plus1d_18"  # å¯é€‰

# ç½‘æ ¼æœç´¢è®¾ç½®
max_experiments: 10  # å‡å°‘å®éªŒæ•°é‡ï¼ˆç®€åŒ–ç‰ˆç”¨äºå¿«é€Ÿæµ‹è¯•ï¼‰
continue_on_error: true
parallel_jobs: 1
save_results: true

# ç½‘æ ¼æœç´¢è¶…å‚æ•° - ç®€åŒ–é…ç½®
grid_search:
  groups:
    # è½»é‡çº§3D CNNæ¨¡å‹ç»„
    light_3d_cnn:
      model.type: ["r3d_18", "mc3_18"]
      hp.batch_size: [16]  # ğŸ”§ ä¼˜åŒ–ï¼šé™ä½batch_sizeå‡å°‘å†…å­˜å‹åŠ›ï¼ˆåŸ16 -> 8ï¼‰
      hp.learning_rate: [0.001]
      optimizer.name: ["adamw"]
      optimizer.params.weight_decay: [0.01]
      scheduler.name: ["warmup_cosine"]
      scheduler.params.warmup_epochs: [2]
      scheduler.params.warmup_start_factor: [1]
      scheduler.params.eta_min_factor: [0.05]

      # ä½¿ç”¨BCEæŸå¤±ï¼ˆç®€åŒ–ç‰ˆå›ºå®šä½¿ç”¨å…¨éƒ¨24ä¸ªç±»åˆ«ï¼Œç±»åˆ«ä¸å¹³è¡¡è¾ƒä¸¥é‡ï¼‰
      loss.name: ["multilabel_bce"]
      loss.params.pos_weight: [10.0]  # æ­£æ ·æœ¬æƒé‡

# è¾“å‡ºé…ç½®
output:
  results_dir: "runs"
  experiment_name: "neonatal_multilabel_simple"
  save_predictions: true
  save_confusion_matrix: true

