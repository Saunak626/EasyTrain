# 新生儿多标签行为识别网格搜索配置 - 简化版
# 使用简化版数据集 NeonatalMultilabelSimple

# 任务配置
task:
  tag: "video_classification"
  description: "新生儿多标签行为识别网格搜索 - 简化版数据集"

# 训练配置
training:
  exp_name: "neonatal_multilabel_simple_exp"
  save_model: true
  model_save_path: "models/neonatal_multilabel_simple_model.pth"

# SwanLab配置
swanlab:
  project_name: "EasyTrain-Neonatal-Multilabel-Simple"
  description: "新生儿多标签行为识别网格搜索实验 - 简化版数据集"

# 数据配置
data:
  type: neonatal_multilabel_simple  # 使用简化版数据集类型
  root: ../Neonate-Feeding-Assessment/data/cpu_processed_627/frames_segments
  num_workers: 12
  params:
    clip_len: 16      # 每个视频片段的帧数
    train_ratio: 0.8  # 训练集比例（简化版独有参数）
    # 标签文件路径
    labels_file: ../Neonate-Feeding-Assessment/result_xlsx/shanghai/multi_hot_labels.xlsx
    
    # 注意：简化版不支持以下参数
    # top_n_classes: 不支持（固定使用全部24个类别）
    # stratified_split: 不支持（使用简单划分）
    # min_samples_per_class: 不支持
    # use_weighted_sampling: 不支持
    # sampling_mode: 不支持（固定使用random采样）
    # target_fps: 不支持
    # original_fps: 不支持

# 超参数配置
hp:
  epochs: 10

# GPU配置
gpu:
  device_ids: "0"
  auto_select: true

# 多卡训练配置
multi_gpu:
  enabled: true
  strategy: "ddp"

# 模型选择配置（简化版：只测试轻量级模型）
models_to_train:
  - "r3d_18"
  - "mc3_18"
  # - "r2plus1d_18"  # 可选

# 网格搜索设置
max_experiments: 10  # 减少实验数量（简化版用于快速测试）
continue_on_error: true
parallel_jobs: 1
save_results: true

# 网格搜索超参数 - 简化配置
grid_search:
  groups:
    # 轻量级3D CNN模型组
    light_3d_cnn:
      model.type: ["r3d_18", "mc3_18"]
      hp.batch_size: [16]  # 使用中等batch_size
      hp.learning_rate: [0.001]
      optimizer.name: ["adamw"]
      optimizer.params.weight_decay: [0.01]
      scheduler.name: ["warmup_cosine"]
      scheduler.params.warmup_epochs: [2]
      scheduler.params.warmup_start_factor: [1]
      scheduler.params.eta_min_factor: [0.05]
      
      # 使用BCE损失（简化版固定使用全部24个类别，类别不平衡较严重）
      loss.name: ["multilabel_bce"]
      loss.params.pos_weight: [10.0]  # 正样本权重

# 输出配置
output:
  results_dir: "runs"
  experiment_name: "neonatal_multilabel_simple"
  save_predictions: true
  save_confusion_matrix: true

